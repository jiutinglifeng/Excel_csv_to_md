# Excel/CSV to Markdown 转换工具

## 简介

本工具是一个 Python 脚本，用于批量将 Excel (`.xlsx`) 和 CSV (`.csv`) 文件转换为 Markdown (`.md`) 格式。转换后的 Markdown 文件将保留在与原始文件相同的目录下，文件名与原始文件相同，但扩展名为 `.md`。

离风发现很多AI大语言模型的知识库平台并不允许用户上传表格（如 Excel 和 CSV），这使得我们的表格数据集没办法上传进去，所以开发了本工具。

本工具旨在快速将表格数据转换为结构化的 Markdown 文档，以方便在AI大语言模型的知识库中上传这些转换后的 Markdown 文件。

## 功能特点

*   **支持 Excel 和 CSV 文件**:  能够处理 `.xlsx` 和 `.csv` 两种常见的表格文件格式。
*   **批量转换**:  可以一次性处理指定目录下的所有 Excel 和 CSV 文件。
*   **结构化 Markdown 输出**:
    *   将表格的第一列内容（表头行除外）转换为 Markdown 的 **一级标题 (`#`)**，形成文档的章节结构。
    *   将表格的后续每一列的表头转换为 Markdown 的 **三级标题 (`###`)**，并将该列的数据内容置于标题下方。
*   **自动文件命名**:  输出的 Markdown 文件名与原始文件相同，方便管理。
*   **错误处理**:  具备基本的错误处理机制，能够提示文件未找到、读取错误等问题。
*   **支持 UTF-8 编码**:  在读取和写入文件时使用 UTF-8 编码，支持更广泛的字符集。

## 使用方法

1.  **安装依赖**:  确保您的 Python 环境中安装了 `pandas` 库。如果未安装，请在终端或命令提示符中运行以下命令进行安装：

    ```bash
    pip install pandas
    ```

2.  **保存脚本**:  将 `excel_csv_to_md.py` (或您保存脚本的文件名) 文件保存到您想要运行脚本的目录。

3.  **准备文件**:  将您需要转换的 Excel (`.xlsx`) 或 CSV (`.csv`) 文件放置在与脚本文件相同的目录中，或者您可以指定其他目录（请参考步骤 5）。

4.  **运行脚本**:  打开终端或命令提示符，导航到脚本所在的目录，并运行以下命令：

    ```bash
    python excel_csv_to_md.py
    ```

5.  **指定目录 (可选)**:  如果您想处理其他目录下的文件，可以修改脚本中的 `target_directory` 变量。在脚本的 `if __name__ == "__main__":` 部分，找到以下行：

    ```python
    target_directory = "./"  # 替换为包含您的 Excel/CSV 文件的目录，或保留 "./" 表示当前目录
    ```

    将 `"./"` 替换为您想要处理的 Excel/CSV 文件所在的目录路径。例如，如果您要处理 `D:\MyDocuments\DataFiles` 目录下的文件，应修改为：

    ```python
    target_directory = "D:\\MyDocuments\\DataFiles"
    ```

    **注意**:  在 Windows 路径中，反斜杠 `\` 需要转义，写成 `\\`。
